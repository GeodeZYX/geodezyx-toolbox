<?xml version="1.0" encoding="UTF-8" ?>
<groops>
	<global>
		<time label="timeStart">00000</time>
		<time label="timeEnd">00000</time>
		<filename label="igsAC10Char">XXXXXXXXXX</filename>
		<filename label="projectName">XXXXXXXXXX</filename>
		<filename label="groopsDataDir">/opt/softs_gnss/groops/data/data</filename>
		<int label="groopsStationInfoDir">/scratch/calcgnss/groops_process/020_conv_sitelogs</int>
		<int label="groopsIgsProds">/scratch/calcgnss/groops_process/021_conv_igs_prods/{igsAC10Char}</int>
		<string label="groopsGnssObs">/scratch/calcgnss/groops_process/022_conv_gnss_obs/</string>
		<string label="groopsTropoDir">/scratch/calcgnss/groops_process/010_conv_tropo_vmf3/</string>
		<int label="groopsOutResults">/scratch/calcgnss/groops_process/030_results/{projectName}</int>
		<string label="groopsStationListDir">/opt/softs_gnss/groops/stationlists</string>
		<int label="groopsStationListFile">station_list_OPERA_01a.txt</int>
	</global>
	<program comment="daily">
		<LoopPrograms>
			<loop>
				<timeIntervals>
					<timeIntervals>
						<uniformSampling>
							<timeStart link="timeStart"/>
							<timeEnd link="timeEnd"/>
							<sampling>1</sampling>
						</uniformSampling>
					</timeIntervals>
					<variableLoopTimeStart>loopTime</variableLoopTimeStart>
					<variableLoopTimeEnd>loopTimeEnd</variableLoopTimeEnd>
				</timeIntervals>
			</loop>
			<continueAfterError>0</continueAfterError>
			<processCountPerIteration>1</processCountPerIteration>
			<parallelLog>1</parallelLog>
			<program comment="{groopsOutResults}/{loopTime:%D}">
				<FileCreateDirectories>
					<directory>{groopsOutResults}/{loopTime:%D}</directory>
				</FileCreateDirectories>
			</program>
			<program comment="uniformSampling">
				<GnssProcessing>
					<timeSeries>
						<uniformSampling>
							<timeStart>loopTime</timeStart>
							<timeEnd>loopTimeEnd</timeEnd>
							<sampling>30/86400</sampling>
						</uniformSampling>
					</timeSeries>
					<timeMargin>0.1</timeMargin>
					<transmitter>
						<GNSS>
							<inputfileTransmitterList>{groopsDataDir}/gnss/transmitter/transmitterList.gps.txt</inputfileTransmitterList>
							<inputfileTransmitterList>{groopsDataDir}/gnss/transmitter/transmitterList.glonass.txt</inputfileTransmitterList>
							<inputfileTransmitterList>{groopsDataDir}/gnss/transmitter/transmitterList.galileo.txt</inputfileTransmitterList>
							<inputfileTransmitterInfo>{groopsDataDir}/gnss/transmitter/transmitterInfo/igs/igsR3/transmitterInfo_igsR3.{prn}.xml</inputfileTransmitterInfo>
							<inputfileAntennaDefintion>{groopsDataDir}/gnss/transmitter/antennaDefinition/igs/igsR3/antennaDefinition_igsR3.dat</inputfileAntennaDefintion>
							<noAntennaPatternFound>
								<useNearestFrequency/>
							</noAntennaPatternFound>
							<inputfileSignalDefintion>{groopsDataDir}/gnss/transmitter/signalDefinition/signalDefinition.xml</inputfileSignalDefintion>
							<inputfileOrbit>{groopsIgsProds}/{loopTime:%D}/orbit/orbit_{loopTime:%D}.{prn}.dat</inputfileOrbit>
							<inputfileAttitude>{groopsIgsProds}/{loopTime:%D}/attitude/attitude_{loopTime:%D}.{prn}.dat</inputfileAttitude>
							<inputfileClock>{groopsIgsProds}/{loopTime:%D}/clock/clock_{loopTime:%D}.{prn}.dat</inputfileClock>
							<interpolationDegree>7</interpolationDegree>
						</GNSS>
					</transmitter>
					<receiver>
						<stationNetwork>
							<inputfileStationList>{groopsStationListDir}/{groopsStationListFile}</inputfileStationList>
							<inputfileStationInfo>{groopsStationInfoDir}/{station}.xml</inputfileStationInfo>
							<inputfileAntennaDefinition>{groopsDataDir}/gnss/receiverStation/antennaDefinition/igs/igsR3/antennaDefinition_igsR3.dat</inputfileAntennaDefinition>
							<noAntennaPatternFound>
								<useNearestFrequency/>
							</noAntennaPatternFound>
							<inputfileAccuracyDefinition>{groopsDataDir}/gnss/receiverStation/accuracyDefinition/accuracyDefinition.xml</inputfileAccuracyDefinition>
							<inputfileStationPosition>{groopsDataDir}/gnss/receiverStation/position/igs/igsR3/stationPosition.{station}.dat</inputfileStationPosition>
							<inputfileObservations>{groopsGnssObs}/{loopTime:%D}/observation/gnssReceiver_{loopTime:%D}.{station}.dat.gz</inputfileObservations>
							<tidalDisplacement>
								<earthTide>
									<inputfileEarthtide>{groopsDataDir}/tides/earthAnelastic2003.xml</inputfileEarthtide>
									<includePermanentTide>0</includePermanentTide>
									<factor>1.0</factor>
								</earthTide>
							</tidalDisplacement>
							<tidalDisplacement>
								<doodsonHarmonicTide>
									<inputfileTides>{groopsDataDir}/tides/oceanTide_fes2014b_n720_version20170520.dat</inputfileTides>
									<inputfileAdmittance>{groopsDataDir}/tides/oceanTide_fes2014b_admittance_linear_linear.txt</inputfileAdmittance>
									<minDegree>1</minDegree>
									<nodeCorr>0</nodeCorr>
									<factor>1.0</factor>
								</doodsonHarmonicTide>
							</tidalDisplacement>
							<tidalDisplacement>
								<poleTide>
									<scale>1.333e-9</scale>
									<outPhase>0.0115</outPhase>
									<inputfileMeanPole>{groopsDataDir}/tides/secularPole2018.xml</inputfileMeanPole>
									<horizontalDisplacement>0.009</horizontalDisplacement>
									<verticalDisplacement>0.033</verticalDisplacement>
									<factor>1.0</factor>
								</poleTide>
							</tidalDisplacement>
							<tidalDisplacement>
								<oceanPoleTide>
									<inputfileOceanPole>{groopsDataDir}/tides/oceanPoleTide_desai2004.dat</inputfileOceanPole>
									<minDegree>2</minDegree>
									<gammaReal>0.6870</gammaReal>
									<gammaImaginary>0.0036</gammaImaginary>
									<inputfileMeanPole>{groopsDataDir}/tides/secularPole2018.xml</inputfileMeanPole>
									<factor>1.0</factor>
								</oceanPoleTide>
							</tidalDisplacement>
							<ephemerides>
								<jpl>
									<inputfileEphemerides>{groopsDataDir}/tides/ephemerides_JPL_DE432.dat</inputfileEphemerides>
									<origin>
										<earth/>
									</origin>
								</jpl>
							</ephemerides>
							<inputfileDeformationLoadLoveNumber>{groopsDataDir}/loading/deformationLoveNumbers_CM_Gegout97.txt</inputfileDeformationLoadLoveNumber>
							<inputfilePotentialLoadLoveNumber>{groopsDataDir}/loading/loadLoveNumbers_Gegout97.txt</inputfilePotentialLoadLoveNumber>
							<useType>L***</useType>
							<useType>C***</useType>
							<ignoreType>C*?G</ignoreType>
							<ignoreType>*6*E</ignoreType>
							<ignoreType>*3*R</ignoreType>
							<ignoreType>L5*G</ignoreType>
							<elevationCutOff>5</elevationCutOff>
							<elevationTrackMinimum>15</elevationTrackMinimum>
							<minObsCountPerTrack>60</minObsCountPerTrack>
							<minEstimableEpochsRatio>0.75</minEstimableEpochsRatio>
							<preprocessing>
								<printStatistics>0</printStatistics>
								<huber>2.5</huber>
								<huberPower>1.5</huberPower>
								<codeMaxPositionDiff>100</codeMaxPositionDiff>
								<denoisingLambda>5</denoisingLambda>
								<tecWindowSize>15</tecWindowSize>
								<tecSigmaFactor>3.5</tecSigmaFactor>
							</preprocessing>
						</stationNetwork>
					</receiver>
					<earthRotation>
						<file>
							<inputfileEOP>{groopsDataDir}/earthRotation/timeSeries_EOP_rapid_IAU2000_desai.dat</inputfileEOP>
							<interpolationDegree>3</interpolationDegree>
						</file>
					</earthRotation>
					<parametrization>
						<ionosphereSTEC>
							<name>parameter.STEC</name>
							<apply2ndOrderCorrection>1</apply2ndOrderCorrection>
							<apply3rdOrderCorrection>1</apply3rdOrderCorrection>
							<applyBendingCorrection>1</applyBendingCorrection>
							<magnetosphere>
								<igrf>
									<inputfileMagneticNorthPole>{groopsDataDir}/magnetosphere/magneticNorthPole.txt</inputfileMagneticNorthPole>
								</igrf>
							</magnetosphere>
							<nameConstraint>constraint.STEC</nameConstraint>
							<sigmaSTEC>40</sigmaSTEC>
						</ionosphereSTEC>
					</parametrization>
					<parametrization>
						<ionosphereVTEC>
							<name>parameter.VTEC</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<outputfileVTEC>{groopsOutResults}/{loopTime:%D}/vtec_{loopTime:%D}.{station}.txt</outputfileVTEC>
							<mapR>6371e3</mapR>
							<mapH>506.7e3</mapH>
							<mapAlpha>0.9782</mapAlpha>
						</ionosphereVTEC>
					</parametrization>
					<parametrization>
						<clocks>
							<name>parameter.clocks</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<nameConstraint>constraintEpoch.clocks</nameConstraint>
							<selectTransmittersZeroMean>
								<all/>
							</selectTransmittersZeroMean>
							<sigmaZeroMeanConstraint>0.0001</sigmaZeroMeanConstraint>
						</clocks>
					</parametrization>
					<parametrization>
						<staticPositions>
							<name>parameter.staticPositions</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<outputfileGriddedPosition>{groopsOutResults}/{loopTime:%D}/gridPosition_{loopTime:%D}.dat</outputfileGriddedPosition>
							<outputfilePosition>{groopsOutResults}/{loopTime:%D}/stationPosition_{loopTime:%D}.{station}.txt</outputfilePosition>
							<nameConstraint>constraint.staticPositions</nameConstraint>
							<selectNoNetReceivers>
								<all/>
							</selectNoNetReceivers>
							<inputfileNoNetPositions>{groopsDataDir}/gnss/receiverStation/position/igs/igb14/stationPosition.{station}.dat</inputfileNoNetPositions>
							<noNetTranslationSigma>0.0</noNetTranslationSigma>
							<noNetRotationSigma>0.00</noNetRotationSigma>
							<huber>2.5</huber>
							<huberPower>1.5</huberPower>
						</staticPositions>
					</parametrization>
					<parametrization>
						<troposphere>
							<name>parameter.troposphere</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<troposphere>
								<viennaMapping>
									<inputfileVmfCoefficients>{groopsTropoDir}/{loopTime:%y}/vmf3_grid_{loopTime:%y-%m-%d}.dat.gz</inputfileVmfCoefficients>
									<inputfileGpt>{groopsDataDir}/troposphere/gpt3_grid1deg.dat</inputfileGpt>
									<aHeight>2.53e-5</aHeight>
									<bHeight>5.49e-3</bHeight>
									<cHeight>1.14e-3</cHeight>
								</viennaMapping>
							</troposphere>
							<troposphereWetEstimation>
								<splines>
									<degree>1</degree>
									<timeSeries>
										<uniformSampling>
											<timeStart>loopTime</timeStart>
											<timeEnd>loopTimeEnd</timeEnd>
											<sampling>2/24</sampling>
										</uniformSampling>
									</timeSeries>
									<includeLastTime>0</includeLastTime>
								</splines>
							</troposphereWetEstimation>
							<troposphereGradientEstimation>
								<splines>
									<degree>1</degree>
									<timeSeries>
										<uniformSampling>
											<timeStart>loopTime</timeStart>
											<timeEnd>loopTimeEnd</timeEnd>
											<sampling>1</sampling>
										</uniformSampling>
									</timeSeries>
									<includeLastTime>0</includeLastTime>
								</splines>
							</troposphereGradientEstimation>
						</troposphere>
					</parametrization>
					<parametrization>
						<signalBiases>
							<name>parameter.signalBiases</name>
							<selectTransmitters>
								<all/>
							</selectTransmitters>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<outputfileSignalBiasReceiver>{groopsOutResults}/{loopTime:%D}/signalBias_{loopTime:%D}.{station}.txt</outputfileSignalBiasReceiver>
							<inputfileSignalBiasTransmitter>{groopsIgsProds}/{loopTime:%D}/signalBias/signalBias_{loopTime:%D}.{prn}.txt</inputfileSignalBiasTransmitter>
						</signalBiases>
					</parametrization>
					<parametrization>
						<codeBiases>
							<name>parameter.codeBiases</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<linearGlonassBias>0</linearGlonassBias>
							<nameConstraint>constraint.codeBiases</nameConstraint>
							<sigmaZeroMeanConstraint>0</sigmaZeroMeanConstraint>
						</codeBiases>
					</parametrization>
					<parametrization>
						<tecBiases>
							<name>parameter.tecBiases</name>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<linearGlonassBias>0</linearGlonassBias>
							<nameConstraint>constraint.tecBiases</nameConstraint>
							<sigmaZeroMeanConstraint>0</sigmaZeroMeanConstraint>
						</tecBiases>
					</parametrization>
					<parametrization>
						<ambiguities>
							<name>parameter.ambiguities</name>
							<estimateReceiverPhaseBias>
								<all/>
							</estimateReceiverPhaseBias>
							<linearGlonassBias>0</linearGlonassBias>
						</ambiguities>
					</parametrization>
					<parametrization>
						<constraints>
							<name>constraint.troposphere</name>
							<parameters>
								<wildcard>
									<object>*</object>
									<type>troposphere*</type>
									<temporal>*</temporal>
									<interval>*</interval>
								</wildcard>
							</parameters>
							<sigma>5</sigma>
							<bias>0</bias>
							<relativeToApriori>1</relativeToApriori>
						</constraints>
					</parametrization>
					<processingStep>
						<writeAprioriSolution>
							<outputfileParameterNames>{groopsOutResults}/{loopTime:%D}/parameterNames_{loopTime:%D}.txt</outputfileParameterNames>
						</writeAprioriSolution>
					</processingStep>
					<processingStep>
						<estimate>
							<computeResiduals>1</computeResiduals>
							<adjustSigma0>1</adjustSigma0>
							<computeWeights>1</computeWeights>
							<huber>2.5</huber>
							<huberPower>1.5</huberPower>
							<convergenceThreshold>0.01</convergenceThreshold>
							<maxIterationCount>6</maxIterationCount>
						</estimate>
					</processingStep>
					<processingStep>
						<resolveAmbiguities>
							<sigmaMaxResolve>0.2</sigmaMaxResolve>
							<searchBlockSize>200</searchBlockSize>
							<maxSearchSteps>200000000</maxSearchSteps>
							<incompleteAction>
								<shrinkBlockSize/>
							</incompleteAction>
							<computeResiduals>1</computeResiduals>
							<adjustSigma0>1</adjustSigma0>
							<computeWeights>1</computeWeights>
							<huber>2.5</huber>
							<huberPower>1.5</huberPower>
						</resolveAmbiguities>
					</processingStep>
					<processingStep>
						<estimate>
							<computeResiduals>1</computeResiduals>
							<adjustSigma0>1</adjustSigma0>
							<computeWeights>1</computeWeights>
							<huber>2.5</huber>
							<huberPower>1.5</huberPower>
							<convergenceThreshold>0.01</convergenceThreshold>
							<maxIterationCount>2</maxIterationCount>
						</estimate>
					</processingStep>
					<processingStep>
						<writeResults/>
					</processingStep>
					<processingStep>
						<writeResiduals>
							<selectReceivers>
								<all/>
							</selectReceivers>
							<outputfileResiduals>{groopsOutResults}/{loopTime:%D}/residuals_{loopTime:%D}.{station}.dat</outputfileResiduals>
						</writeResiduals>
					</processingStep>
				</GnssProcessing>
			</program>
		</LoopPrograms>
	</program>
</groops>
